import{s as T,k as g,a as y,g as I,i as w,f as h,P as W,e as B,c as L,l as X,m as U,n as S,t as q,d as A,J as Y,b as Z,h as ee}from"../chunks/scheduler.CjD0NZ8o.js";import{S as v,i as M,c as u,a as m,m as f,t as d,b as $,d as p}from"../chunks/index.or77jMZA.js";import{R as te,T as ne,a as re,b as oe,c as ae,d as se,e as le,f as ce,g as ie,h as ue,i as me,D as fe}from"../chunks/date.DCN9688O.js";import{D as de,T as $e}from"../chunks/table.Bbh0fYby.js";import{B as pe}from"../chunks/index.Cy1MAQMk.js";import{d as _e}from"../chunks/system.DiN6QSf-.js";import{f as E,a as ge}from"../chunks/fetch.UBuoTI4j.js";import{w as D}from"../chunks/index.BLWFmFSp.js";import{D as he,a as we}from"../chunks/DotsHorizontal.pqD2To3M.js";import{a as be}from"../chunks/alert.PramJLuh.js";const C=D([]),Ce=D(0),De=D(["reply_comment_id","root_comment_id","link"]),H=D("");function xe(s=""){E.get(`comment?q=${s}`).then(e=>{e.ok&&(C.set(e.data.data),Ce.set(e.data.pagination.count),H.set(s))})}function ke(s){let e,n,t,r="Open Menu",o;return e=new he({props:{class:"h-4 w-4"}}),{c(){u(e.$$.fragment),n=y(),t=B("span"),t.textContent=r,this.h()},l(a){m(e.$$.fragment,a),n=I(a),t=L(a,"SPAN",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-1kgmsd2"&&(t.textContent=r),this.h()},h(){U(t,"class","sr-only")},m(a,l){f(e,a,l),w(a,n,l),w(a,t,l),o=!0},p:S,i(a){o||(d(e.$$.fragment,a),o=!0)},o(a){$(e.$$.fragment,a),o=!1},d(a){a&&(h(n),h(t)),p(e,a)}}}function Te(s){let e,n;return e=new pe({props:{variant:"ghost",builders:[s[4]],class:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",$$slots:{default:[ke]},$$scope:{ctx:s}}}),{c(){u(e.$$.fragment)},l(t){m(e.$$.fragment,t)},m(t,r){f(e,t,r),n=!0},p(t,r){const o={};r&16&&(o.builders=[t[4]]),r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){p(e,t)}}}function ye(s){let e;return{c(){e=q("⌘⌫")},l(n){e=A(n,"⌘⌫")},m(n,t){w(n,e,t)},d(n){n&&h(e)}}}function Ie(s){let e,n,t;return n=new we({props:{$$slots:{default:[ye]},$$scope:{ctx:s}}}),{c(){e=q(`删除
      `),u(n.$$.fragment)},l(r){e=A(r,`删除
      `),m(n.$$.fragment,r)},m(r,o){w(r,e,o),f(n,r,o),t=!0},p(r,o){const a={};o&32&&(a.$$scope={dirty:o,ctx:r}),n.$set(a)},i(r){t||(d(n.$$.fragment,r),t=!0)},o(r){$(n.$$.fragment,r),t=!1},d(r){r&&h(e),p(n,r)}}}function Se(s){let e,n;return e=new de({props:{$$slots:{default:[Ie]},$$scope:{ctx:s}}}),e.$on("click",s[2]),{c(){u(e.$$.fragment)},l(t){m(e.$$.fragment,t)},m(t,r){f(e,t,r),n=!0},p(t,r){const o={};r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){p(e,t)}}}function ve(s){let e,n,t,r;return e=new ne({props:{asChild:!0,$$slots:{default:[Te,({builder:o})=>({4:o}),({builder:o})=>o?16:0]},$$scope:{ctx:s}}}),t=new re({props:{class:"w-[160px]",align:"end",$$slots:{default:[Se]},$$scope:{ctx:s}}}),{c(){u(e.$$.fragment),n=y(),u(t.$$.fragment)},l(o){m(e.$$.fragment,o),n=I(o),m(t.$$.fragment,o)},m(o,a){f(e,o,a),w(o,n,a),f(t,o,a),r=!0},p(o,a){const l={};a&48&&(l.$$scope={dirty:a,ctx:o}),e.$set(l);const _={};a&33&&(_.$$scope={dirty:a,ctx:o}),t.$set(_)},i(o){r||(d(e.$$.fragment,o),d(t.$$.fragment,o),r=!0)},o(o){$(e.$$.fragment,o),$(t.$$.fragment,o),r=!1},d(o){o&&h(n),p(e,o),p(t,o)}}}function Me(s){let e,n;return e=new te({props:{$$slots:{default:[ve]},$$scope:{ctx:s}}}),{c(){u(e.$$.fragment)},l(t){m(e.$$.fragment,t)},m(t,r){f(e,t,r),n=!0},p(t,[r]){const o={};r&33&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){p(e,t)}}}function Oe(s,e,n){let t;g(s,C,l=>n(3,t=l));let{row:r}=e;function o(){E.delete(`comment/${r.id}`).then(l=>{l.ok&&W(C,t=t.filter(_=>_.id!==r.id),t)})}const a=()=>{be(`删除评论 “ ${r.content} ”`).then(()=>{o()})};return s.$$set=l=>{"row"in l&&n(0,r=l.row)},[r,o,a]}class Re extends v{constructor(e){super(),M(this,e,Oe,Me,T,{row:0})}}function Ve(s){let e,n;return e=new $e({props:{tableModel:s[1],filters:s[0],viewOption:s[2]}}),{c(){u(e.$$.fragment)},l(t){m(e.$$.fragment,t)},m(t,r){f(e,t,r),n=!0},p:S,i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){p(e,t)}}}function ze(s,e,n){let t,r,o,a,l,_;g(s,H,c=>n(16,_=c));const x=!ge,i=se(C,{page:le({}),filter:ce({serverSide:x,fn:({filterValue:c,value:G})=>G.toLowerCase().includes(c.toLowerCase())}),colFilter:ie({serverSide:x}),hide:ue(),sort:me({serverSide:x,toggleOrder:["asc","desc"]})}),J=i.createColumns([i.column({accessor:"id",header:"ID"}),i.column({accessor:"name",header:"Name"}),i.column({accessor:"email",header:"Email"}),i.column({accessor:"link",header:"Link"}),i.column({accessor:"content",header:"Content"}),i.column({accessor:"article_id",header:"Article ID"}),i.column({accessor:"reply_comment_id",header:"Reply Comment ID"}),i.column({accessor:"root_comment_id",header:"Root Comment ID"}),i.column({accessor:"created",header:"Created",cell:({value:c})=>oe(c),plugins:{filter:{exclude:!0}}}),i.display({id:"actions",header:()=>"",cell:({row:c})=>c.isData()&&c.original?ae(Re,{row:c.original}):""})]),K=[],O=i.createViewModel(J),Q={type:"hideColumn",selected:De,options:[]},{pluginStates:b}=O,{pageIndex:R,pageSize:V}=b.page;g(s,R,c=>n(13,l=c)),g(s,V,c=>n(12,a=c));const z=b.filter.filterValue;g(s,z,c=>n(11,o=c));const{filterValues:F}=b.colFilter;g(s,F,c=>n(10,r=c));const{sortKeys:N}=b.sort;g(s,N,c=>n(9,t=c));let k=!1;Y(()=>{n(8,k=!0)});let P;const j=_e(()=>{const c=encodeURIComponent(JSON.stringify(P));_!==c&&xe(c)},200);return s.$$.update=()=>{s.$$.dirty&16128&&k&&(P={page:l,page_size:a,filter_text:o,filter_values:r,sort_key:t[0]},j())},[K,O,Q,R,V,z,F,N,k,t,r,o,a,l]}class Fe extends v{constructor(e){super(),M(this,e,ze,Ve,T,{})}}function Ne(s){let e,n,t,r,o;return n=new fe({props:{text:"New Comment",onClick:Pe,disabled:!0}}),r=new Fe({}),{c(){e=B("div"),u(n.$$.fragment),t=y(),u(r.$$.fragment),this.h()},l(a){e=L(a,"DIV",{class:!0});var l=Z(e);m(n.$$.fragment,l),t=I(l),m(r.$$.fragment,l),l.forEach(h),this.h()},h(){U(e,"class","container mx-auto")},m(a,l){w(a,e,l),f(n,e,null),ee(e,t),f(r,e,null),o=!0},p:S,i(a){o||(d(n.$$.fragment,a),d(r.$$.fragment,a),o=!0)},o(a){$(n.$$.fragment,a),$(r.$$.fragment,a),o=!1},d(a){a&&h(e),p(n),p(r)}}}const Pe=()=>{};class Ge extends v{constructor(e){super(),M(this,e,null,Ne,T,{})}}export{Ge as component};
